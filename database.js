var db=new Dexie("db-iot"),schema={user:"++id",gateway:"++id",station:"++id",datasource:"++id",sensor:"++id"};function populateAJAX(o){db.on("ready",function(){return db.table(o).count(async function(n){if(!(n>0))return console.log("Database is empty. Populating from ajax call..."),new Promise(function(n,e){$.ajax("/iot/get.php?from="+o,{type:"get",dataType:"json",error:function(o,n){e(n)},success:function(o){n(o)}})}).then(function(n){return console.log("Got ajax response. We'll now add the objects."),console.log("Calling bulkAdd() to insert objects..."),console.log(n),db.table(o).bulkAdd(n)}).then(function(){console.log("Done populating.")});console.log("Already populated")})})}function readFrom(o){db.table(o).each(function(o){console.log("Found object: "+JSON.stringify(o))}).then(function(){console.log("Finished.")}).catch(function(o){console.error(o.stack||o)})}db.version(1).stores(schema);
